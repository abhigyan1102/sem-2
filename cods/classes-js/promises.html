<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Promises class</title>
  </head>
  <body>
    <script>
      const cart = ["shoes", "pants", "kurta"];

      const promise = createOrder(cart); // An async function â€” will get orderId

      // Print promise
      console.log(promise);

      // Consume
      promise.then(function (orderId) {
        // This runs when promise is fulfilled
        console.log(orderId);
      });

      // Creation of promise / backend side / producer side
      function createOrder(cart) {
        const pr = new Promise(function (resolve, reject) {
          // createOrder
          // validate the cart (check in stock)
          // return orderId

          // Fail-first approach
          if (!validateCart(cart)) {
            setTimeout(function () {
              // mimicking BE jobs
              const err = new Error("Cart is invalid");
              reject(err);
            }, 2000);
            return;
          }

          // logic for createOrder
          const orderId = "1210";

          if (orderId) {
            setTimeout(function () {
              // mimicking BE jobs
              resolve(orderId);
            }, 5000);
          }
        });

        return pr;
      }

      // Dummy validation function
      function validateCart(cart) {
        return true;
      }
    </script>
  </body>
</html>
